{
  "hash": "9502be0d43dddff3e3d505dd2cba66f1",
  "result": {
    "markdown": "---\ntitle: \"Cours de manipulation des données\"\nauthor: \"Profs programmation R\"\ndate: 2022-09-19\ncategories: [Talk, Shiny, Dashboards, Interactive]\nformat: html\n---\n\n\n## Coordonnées et références\n\n\\center Servane.Gey@parisdescartes.fr - Bureau B4-18 \\center\n\n* **Documents** :\nMoodle, COMMUN\n     \n* **Références** (liste non-exhaustive) :\n    + *Cours de F.-X. Jollois* : https://fxjollois.github.io/cours-2018-2019/stid-2afa--prog-r/\n    + *R for Data Science*, H. Wickham & G. Grolemund, O'Reilly, (https://r4ds.had.co.nz/)\n    + *The Grammar of Graphics*, L. Wilkinson, Springer (https://www.springer.com/us/book/9780387245447)\n    + *Tidyverse* : https://tidyverse.tidyverse.org/\n    + *Visualisation* : https://ggplot2.tidyverse.org/reference/\n    + *Applications Web* : https://shiny.rstudio.com/\n    + *R Markdown* : https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf\n    + *RStudio Cheat Sheets* : https://www.rstudio.com/resources/cheatsheets/\n\n## Organisation et validation\n\n* **Organisation** :\n    + 33h de cours et TP répartis sur 11 séances de 3h  \n    \n\n* **Validation** :\n    + 1 TP noté en milieu de semestre (50 %)  \n    \n    + 1 DST sur machine en fin de semestre (50 %)  \n    \n\n## Plan du cours\n\n1. **Manipulation et analyse de données**\n    + Importation et exportation de données (package *readr*)\n    + Manipulation de tables de données (package *dplyr*)\n    + Statistiques : quelques exemples avec *dplyr*\n\n2. **Visualisation de Données**\n    + Représentations graphiques (package *ggplot2*)\n    + Cartographie (package *leaflet*)\n\n3. **Fonctions**\n    + Ecriture de fonctions avec *dplyr*\n    + Fonctions spécifiques à l'analyse de données\n    + Gestion des sorties sous forme de listes\n    \n4. **Rapports et Présentations**\n    + Rappels sur R Markdown\n    + Rédaction de rapports et de présentations\n    \n5. **Applications Web**\n    + Rappels sur R Shiny\n    + Tableaux de bord (package *shinydashboard*)\n    + Conception d'une application avec interface utilisateur\n\n## Installation de R et RStudio en local\n\n* Télécharger la dernière version de R adaptée à votre système d'exploitation (Windows, Mac OS, Linux) via le CRAN de l'université de Lyon :\nhttps://pbil.univ-lyon1.fr/CRAN/  \n\n* Télécharger la dernière version de RStudio adaptée à votre système d'exploitation (Windows, Mac OS, Linux) via le site rstudio :\nhttps://rstudio.com/products/rstudio/download/   \n\n* Installer les 2 logiciels en éxécutant les fichiers téléchargés.  \n\n* **Attention** RStudio est une interface graphique très évoluée pour une utilisation simplifiée du logiciel R. L'installation de R au préalable est donc indispensable avant toute utilisation de RStudio.  \n\n* L'installation des librairies (ou *packages*) peut se faire directement via la console, ou via l'interface de RStudio.\n\n## Serveur RStudio\n\n* Serveur dédié à l'utiliation de R, dont la dernière version y est installée, avec toutes les librairies régulièrement mises à jour.  \n\n* Connexion sur l'interface RStudio directement via la connexion sur le serveur. \n\n* Serveur RStudio de l'IUT (disponible uniquement en local, i.e. sur les ordinateurs de l'IUT) : hhtp://rstudio.iutparis.local:8787/  \n\n* Première connexion : login et mot de passe = login de l'IUT.  \n\n* Changer immédiatement votre mot de passe (voir le mail de M. Jollois). \n\n## Introduction\n\n* **R** : \n    + langage de programmation pour le traitement des données\n    + fonctions propres intégrées au langage\n    + nombreuses librairies\n    \n* **tidyverse** : \n    + ensemble de librairies développées par l'équipe de R Studio\n    + librairies principalement utilisées dans ce cours : *magrittr*, *tibble*, *dplyr*, *readr*, *readxls*, *ggplot2*\n    \n* **Data frames** : \n    + format des données dans R\n    + *observations* (=individus) en lignes et *variables* en colonnes\n\n* **tibble** : \n    + format *tbl_df* basé sur un *data.frame*\n    + traitement identique aux *data.frame*\n\n* **Conseils** :\n    + préférer les librairies développées par des laboratoires ou des entreprises (mises à jour susceptibles d'être plus régulières)\n    + écrire et sauvegarder ses codes dans un script R ou R Studio\n    + se référencer à l'aide pour l'utilisation des fonctions\n\n## Les données avec *tibble*\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(mtcars)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   mpg cyl disp  hp drat    wt  qsec vs am gear carb\nMazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\nMazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\nDatsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\nHornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\nHornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\nValiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tibble)\nas_tibble(mtcars)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 32 × 11\n     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb\n   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n 1  21       6  160    110  3.9   2.62  16.5     0     1     4     4\n 2  21       6  160    110  3.9   2.88  17.0     0     1     4     4\n 3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1\n 4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1\n 5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2\n 6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1\n 7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4\n 8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2\n 9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2\n10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4\n# … with 22 more rows\n```\n:::\n:::\n\n\n\n# Manipulation et Analyse de Données\n\n## Importation de données à partir de fichiers externes\n\n* Importation de données à partir de fihiers externes de divers formats\n\n* Importation à partir d'un fichier .txt :\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\niris = read_delim(\"Donnees/iris.txt\", delim=\"\\t\")\niris\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 150 × 5\n   `Sepal Length` `Sepal Width` `Petal Length` `Petal Width` Species\n            <dbl>         <dbl>          <dbl>         <dbl> <chr>  \n 1            5.1           3.5            1.4           0.2 setosa \n 2            4.9           3              1.4           0.2 setosa \n 3            4.7           3.2            1.3           0.2 setosa \n 4            4.6           3.1            1.5           0.2 setosa \n 5            5             3.6            1.4           0.2 setosa \n 6            5.4           3.9            1.7           0.4 setosa \n 7            4.6           3.4            1.4           0.3 setosa \n 8            5             3.4            1.5           0.2 setosa \n 9            4.4           2.9            1.4           0.2 setosa \n10            4.9           3.1            1.5           0.1 setosa \n# … with 140 more rows\n```\n:::\n:::\n\n\n## Importation de données à partir de fichiers externes (2)\n* Importation à partir d'un fichier .xlsx :\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\niris = read_excel(\"Donnees/iris.xlsx\")\nstr(iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [150 × 5] (S3: tbl_df/tbl/data.frame)\n $ Sepal Length: num [1:150] 5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...\n $ Sepal Width : num [1:150] 3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...\n $ Petal Length: num [1:150] 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...\n $ Petal Width : num [1:150] 0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...\n $ Species     : chr [1:150] \"setosa\" \"setosa\" \"setosa\" \"setosa\" ...\n```\n:::\n:::\n\n\n## Importation de données à partir de fichiers externes (3)\n* Importation à partir d'un fichier SAS :\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haven)\niris = read_sas(\"Donnees/iris.sas7bdat\")\niris\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 150 × 5\n   Sepal_Length Sepal_Width Petal_Length Petal_Width Species\n          <dbl>       <dbl>        <dbl>       <dbl> <chr>  \n 1          5.1         3.5          1.4         0.2 setosa \n 2          4.9         3            1.4         0.2 setosa \n 3          4.7         3.2          1.3         0.2 setosa \n 4          4.6         3.1          1.5         0.2 setosa \n 5          5           3.6          1.4         0.2 setosa \n 6          5.4         3.9          1.7         0.4 setosa \n 7          4.6         3.4          1.4         0.3 setosa \n 8          5           3.4          1.5         0.2 setosa \n 9          4.4         2.9          1.4         0.2 setosa \n10          4.9         3.1          1.5         0.1 setosa \n# … with 140 more rows\n```\n:::\n:::\n\n\n<!-- ## Importation de données issues du Web -->\n\n<!-- * Données de type JSON (très utilisé sur le web)  -->\n<!-- * Exemple : site [SWAPI](https://swapi.co/) référençant toutes les informations disponibles sur la saga Star Wars  -->\n\n<!-- ```{r} -->\n<!-- library(jsonlite) -->\n<!-- fromJSON(\"https://swapi.co/api/people/1/\") -->\n<!-- ``` -->\n\n## Importation de données issues du Web (2)\n\n2. Lecture de pages Web\n    + Exemple\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rvest)\nsw = read_html(\"https://www.imdb.com/title/tt0076759/\")\n```\n:::\n\n\n\n## Manipulation de données \n\n* Le \"pipe\" %>% (package *magrittr*) : ctrl+shift+m\n      + permet d'enchaîner les opérations \n      + écriture plus naturelle et plus lisible\n\n::: {.cell}\n\n```{.r .cell-code}\nx = c(1,4,2,3,6,10,2,11)\nmean(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.875\n```\n:::\n\n```{.r .cell-code}\nx %>% mean\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.875\n```\n:::\n:::\n\n\n* Manipulation de données (package *dplyr*) : ajouts de variables, filtres, organisation, etc...\n\n\n## Manipulation de données (2)\n\n* Ajouter à la table de données mtcars le nom des modèles de voiture contenu dans les noms de lignes de la table (nouvelle variable dénommée *model*) :\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tibble)\ncars = mtcars %>% rownames_to_column(\"model\")\n```\n:::\n\n\n* Filtrer les observations suivant les valeurs de variables\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\ncars %>% filter(mpg>=30)\ncars %>% filter(cyl==4)\ncars %>% filter(cyl==4 & qsec >17)\ncars %>% filter(between(mpg, 30, 32))\n```\n:::\n\n\n## Manipulation de données (3)\n\n* Sélection de lignes par leurs indices (numéros)\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% slice(1:2)\ncars %>% slice(c(2,6))\ncars %>% slice(seq(1,n(), by=4))\ncars %>% slice(31:n())\n```\n:::\n\noù $n()$ est le nombre de lignes de la table\n\n* Sélection de variables\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% select(model)\ncars %>% select(mpg,cyl,model)\ncars %>% select(2,5,7)\ncars %>% select(starts_with(\"m\"))\n```\n:::\n\nVoir ?select_helpers pour la liste des possibilités\n\n## Manipulation de données (4)\n\n* Tri selon les valeurs d'une ou plusieurs variables\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% arrange(mpg)\ncars %>% arrange(am,mpg)\ncars %>% arrange(desc(mpg))\n```\n:::\n\noù desc() indique un ordre décroissant.\n\n* Ajout de variables\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% mutate(cyl_ratio=cyl/carb)\ncars %>% mutate(cyl_ratio=cyl/carb, wt_ratio=wt/hp)\n```\n:::\n\n\n* Pour garder uniquement la variable créée\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% transmute(cyl_ratio=cyl/carb)\n```\n:::\n\n\n## Manipulation de données (5)\n\n* Suppression des doublons\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(cars$cyl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6 4 8\n```\n:::\n\n```{.r .cell-code}\ncars %>% select(cyl) %>% distinct\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  cyl\n1   6\n2   4\n3   8\n```\n:::\n:::\n\n\n## Manipulation de données (6)\n\n* Enchaîner les opérations\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% select(starts_with(\"c\")) %>% summary\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      cyl             carb      \n Min.   :4.000   Min.   :1.000  \n 1st Qu.:4.000   1st Qu.:2.000  \n Median :6.000   Median :2.000  \n Mean   :6.188   Mean   :2.812  \n 3rd Qu.:8.000   3rd Qu.:4.000  \n Max.   :8.000   Max.   :8.000  \n```\n:::\n\n```{.r .cell-code}\ncars %>% select(mpg,wt,hp) %>% as_tibble %>% head\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n    mpg    wt    hp\n  <dbl> <dbl> <dbl>\n1  21    2.62   110\n2  21    2.88   110\n3  22.8  2.32    93\n4  21.4  3.22   110\n5  18.7  3.44   175\n6  18.1  3.46   105\n```\n:::\n:::\n\n\n## Manipulation de données (7)\n\n* Grouper les individus en fonction des modalités d'une variable\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% group_by(cyl)\n```\n:::\n\n\n* Exemple : déterminer le nombre de modèles de la table *cars* dans chaque catégorie de cylindre\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% group_by(cyl) %>% summarise(n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n    cyl     n\n  <dbl> <int>\n1     4    11\n2     6     7\n3     8    14\n```\n:::\n:::\n\n\n\n## Manipulation de données (8)\n\n* Joindre deux tables en fonction des valeurs de l'une des variables\n\n::: {.cell}\n\n```{.r .cell-code}\nengine = tibble(\n  cyl = c(6,8,12),\n  type = c(\"medium\", \"big\", \"very big\")\n)\n```\n:::\n\nExtraction des tables en jointure entre cars et engine :\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% inner_join(engine) \ncars %>% left_join(engine)\ncars %>% right_join(engine)\ncars %>% full_join(engine)\ncars %>% semi_join(engine)\ncars %>% anti_join(engine)\n```\n:::\n\n\n## TP : Exercice 1 (avec *tibble*, *dplyr* et *readr*)\n\n* Donner la liste des différentes espèces d'iris dans la table *iris*\n* Sélectionner \n    + les 60 premiers iris de la table\n    + les 50 derniers iris de la table\n    + 1 iris sur 10 dans la table\n* Sélectionner les iris ayant les plus longues Sépales et les plus longues Pétales. En donner la répartition par espèce.\n* Créer une nouvelle table en organisant la table *iris* par ordre alphabétique des espèces et par ordre croissant des longueurs de Sépale\n* Créer une nouvelle table en ajoutant 2 colonnes à la table *iris* contenant respectivement les rapports longueur/largeur de Sépale et de Pétale \n* Importer les 4 tables concernant les indicateurs de gouvernance fournis par la banque mondiale, *WGIValues.csv*, *WGICountry.csv*, *WGISerie.csv* et *WGIType.csv*\n* Créer une nouvelle table contenant les noms des pays, séries et indicateurs à la place des codes correspondants\n\n## Données spécifiques\n\n* Gestion de chaînes de caractères (package *stringr*) :\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(stringr)\nstr_length(cars$model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  9 13 10 14 17  7 10  9  8  8  9 10 10 11 18 19 17  8 11 14 13 16 11 10 16\n[26]  9 13 12 14 12 13 10\n```\n:::\n\n```{.r .cell-code}\nstr_c(cars$model, collapse = \", \")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Mazda RX4, Mazda RX4 Wag, Datsun 710, Hornet 4 Drive, Hornet Sportabout, Valiant, Duster 360, Merc 240D, Merc 230, Merc 280, Merc 280C, Merc 450SE, Merc 450SL, Merc 450SLC, Cadillac Fleetwood, Lincoln Continental, Chrysler Imperial, Fiat 128, Honda Civic, Toyota Corolla, Toyota Corona, Dodge Challenger, AMC Javelin, Camaro Z28, Pontiac Firebird, Fiat X1-9, Porsche 914-2, Lotus Europa, Ford Pantera L, Ferrari Dino, Maserati Bora, Volvo 142E\"\n```\n:::\n\n```{.r .cell-code}\nstr_sub(cars$model, 1, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Mazda\" \"Mazda\" \"Datsu\" \"Horne\" \"Horne\" \"Valia\" \"Duste\" \"Merc \" \"Merc \"\n[10] \"Merc \" \"Merc \" \"Merc \" \"Merc \" \"Merc \" \"Cadil\" \"Linco\" \"Chrys\" \"Fiat \"\n[19] \"Honda\" \"Toyot\" \"Toyot\" \"Dodge\" \"AMC J\" \"Camar\" \"Ponti\" \"Fiat \" \"Porsc\"\n[28] \"Lotus\" \"Ford \" \"Ferra\" \"Maser\" \"Volvo\"\n```\n:::\n:::\n\n\n## Données spécifiques (2)\n\n* Gestion des expressions régulières (package *stringr*) :\n\n::: {.cell}\n\n```{.r .cell-code}\nstr_subset(cars$model, \"Merc\")\nstr_subset(cars$model, \"[0-9]\")\nstr_detect(cars$model, \"[0-9]\")\nstr_match(cars$model, \"(.+)[ ](.+)\")\nstr_split(cars$model, \" \")\n```\n:::\n\n\n## TP : Exercice 2 (avec *stringr*)\n\n* Créer le vecteur x composé des $5$ chaînes de caractères suivantes : \"Je\" \"suis\" \"en\" \"DUT\" \"STID\"   \n\n* Ajouter la chaîne \"alternance\" à la fin du vecteur x\n* Donner le nombre de caractères composant chaque élément de x\n* Ajouter une majuscule à \"alternance\" (indication : str_to_title)\n* Trouver tous les éléments de x contenant le caractère \"e\" et les extraire.\n* Concaténer les éléments de x afin de ne former qu'une seule phrase. Combien de caractères contient ce nouvel objet ? Interpréter.\n* Re-découper l'objet obtenu en chaînes de caractères distinctes\n\n## Dates\n\n* Gestion des dates aisée (package *lubridate*)\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lubridate)\nnow()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2022-11-12 12:36:25 CET\"\n```\n:::\n\n```{.r .cell-code}\ntoday = today()\ntoday\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2022-11-12\"\n```\n:::\n\n```{.r .cell-code}\nyear(today)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2022\n```\n:::\n:::\n\n\n## Dates (2)\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth(today)\nmonth(today, label = TRUE)\nmonth(today, label = TRUE, abbr = FALSE)\nday(today)\nmday(today)\nwday(today)\nwday(today, label = TRUE)\nwday(today, label = TRUE, week_start = 1)\nwday(today, week_start = 1)\nyday(today)\n```\n:::\n\n\n## Dates (3)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntoday + period(week = 1, day = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2022-11-22\"\n```\n:::\n\n```{.r .cell-code}\ntoday + period(\"1W 3D\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2022-11-22\"\n```\n:::\n\n```{.r .cell-code}\ntoday - years(1) - days(10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2021-11-02\"\n```\n:::\n:::\n\n\n## Dates (4)\n\n* Calculer des périodes en secondes ou en années (par défaut en jours) :\n\n::: {.cell}\n\n```{.r .cell-code}\nbday = ymd(\"19771114\")\ndiff = today - bday\ndiff\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime difference of 16434 days\n```\n:::\n\n```{.r .cell-code}\nas.period(diff)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"16434d 0H 0M 0S\"\n```\n:::\n\n```{.r .cell-code}\nas.duration(diff)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"1419897600s (~44.99 years)\"\n```\n:::\n:::\n\n\n## TP : Exercice 3 (avec *tibble*, *dplyr*, *stringr*)\n\n* Afficher le jeu de données *starwars* (package *dplyr*)\n* Donner le nombre total de personnages distincts apparaissant dans les trilogies \"Star Wars\" (indication : nrow)\n* Donner le pourcentage de valeurs manquantes par variable (indication : is.na, colSums)\n* Faire de même avec les personnages (indication : rowSums)\n* Lister les différentes races des personnages de la table *starwars*. Combien de races apparaissent dans les trilogies \"Star Wars\" ?\n* Donner le nombre de personnages dans chaque race, en triant par ordre décroissant de ce nombre\n* Choisir 2 races pour lesquelles on dénombre plus de 2 personnages et donner le nom de ces personnages. Quels sont les personnages dont la race est indéfinie ? (indication : is.na)\n* **Optionnel** : donner les noms des personnages ayant changé de couleur de cheveux (indication : regarder la variable hair_color et utiliser la librairie *stringr*)\n* **Optionnel** : quels personnages apparaissent dans plus de 4 films ? (indication : bind_cols, add_column)\n\n\n## Statistiques sous R : quelques exemples\n\n* Résumer une ou plusieurs variables dans un data.frame :\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% summarise(n=n(), mpg_av=mean(mpg), \n                   wt_med=median(wt))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   n   mpg_av wt_med\n1 32 20.09062  3.325\n```\n:::\n:::\n\n\n* Résumer toutes les variables dans un data.frame suivant le même indicateur statistique :\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars %>% summarise_all(mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       mpg    cyl     disp       hp     drat      wt     qsec     vs      am\n1 20.09062 6.1875 230.7219 146.6875 3.596563 3.21725 17.84875 0.4375 0.40625\n    gear   carb\n1 3.6875 2.8125\n```\n:::\n:::\n\n\n## Statistiques sous R : quelques exemples (2)\n\n* Résumer par groupes définis par les modalités d'une variable :\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% group_by(cyl) %>% \n  summarise(n=n(), mpg_av=mean(mpg), wt_med=median(wt))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 4\n    cyl     n mpg_av wt_med\n  <dbl> <int>  <dbl>  <dbl>\n1     4    11   26.7   2.2 \n2     6     7   19.7   3.22\n3     8    14   15.1   3.76\n```\n:::\n:::\n\n\n## Statistiques sous R : quelques exemples (2)\n\n* Utilisation des fonctions descriptives classiques \n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% select(mpg,wt,qsec) %>% colMeans\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     mpg       wt     qsec \n20.09062  3.21725 17.84875 \n```\n:::\n\n```{.r .cell-code}\ncars %>% select(mpg,wt,qsec) %>% cor\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            mpg         wt       qsec\nmpg   1.0000000 -0.8676594  0.4186840\nwt   -0.8676594  1.0000000 -0.1747159\nqsec  0.4186840 -0.1747159  1.0000000\n```\n:::\n:::\n\n\n## Statistiques sous R : quelques exemples (3)\n\n* Calculs d'agrégats sur toutes les variables \n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% group_by(cyl) %>% \n  select(cyl,mpg,wt,qsec) %>% \n  summarise_all(mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 4\n    cyl   mpg    wt  qsec\n  <dbl> <dbl> <dbl> <dbl>\n1     4  26.7  2.29  19.1\n2     6  19.7  3.12  18.0\n3     8  15.1  4.00  16.8\n```\n:::\n:::\n\n\n## Statistiques sous R : quelques exemples (4)\n\n* Production de graphiques avec les fonctions de base\n\n::: {.cell}\n\n```{.r .cell-code}\ncars %>% select(mpg,wt) %>% \n  plot(main=\"Weight vs Miles/gallon\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-33-1.png){width=384}\n:::\n:::\n\n\n## TP : Exercice 4 (avec *tibble*, *dplyr*)\n\n* Afficher les indicateurs statistiques résumant les données *iris*  \n\n* Créer deux tables résumant ces mêmes données dont les valeurs sont, par espèce, le nombre d'iris, les moyennes et les médianes de chaque variable, l'une concernant les Sépales, l'autre les Pétales  \n\n* Créer une seule table rassemblant toutes les informations précédentes  \n\n* Représenter la distribution des espèces sous forme de diagramme en barres et de diagramme circulaire (indication : table, barplot, pie)  \n\n* Représenter le lien entre la couleur des yeux et la couleur des cheveux des personnages de la base de données *starwars* (indication : table, barplot)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}